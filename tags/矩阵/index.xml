<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>矩阵 on 111qqz的小窝</title><link>https://111qqz.com/tags/%E7%9F%A9%E9%98%B5/</link><description>Recent content in 矩阵 on 111qqz的小窝</description><generator>Hugo -- gohugo.io</generator><language>zh</language><copyright>Copyright © 2012-2022 all rights reserved.</copyright><lastBuildDate>Mon, 02 Oct 2017 02:24:09 +0000</lastBuildDate><atom:link href="https://111qqz.com/tags/%E7%9F%A9%E9%98%B5/index.xml" rel="self" type="application/rss+xml"/><item><title>codeforces 385 E. Bear in the Field (先记录想法）</title><link>https://111qqz.com/2017/10/codeforces-div2-385e/</link><pubDate>Mon, 02 Oct 2017 02:24:09 +0000</pubDate><guid>https://111qqz.com/2017/10/codeforces-div2-385e/</guid><description>
&lt;p>&lt;a href="http://codeforces.com/problemset/problem/385/E">题目链接&lt;/a>&lt;/p>
&lt;h1 id="题意">题意：&lt;/h1>
&lt;p>有一只熊，初始在(sx,sy)处，如果当前的位置在(x,y)，那么下一秒会在((x+dx-1)%n+1,(y+dy-1)%n+1)处， dx[i] = k[i-1] + dx[i-1],dy[i]=k[i-1] + dy[i-1]，k表示的是某个点的花丛数目。&lt;/p></description></item><item><title>UVA - 10518 How Many Calls? (构造矩阵，快速幂)</title><link>https://111qqz.com/2017/10/uva-10518/</link><pubDate>Sun, 01 Oct 2017 11:10:16 +0000</pubDate><guid>https://111qqz.com/2017/10/uva-10518/</guid><description>
&lt;p>&lt;a href="https://vjudge.net/contest/188289#problem/O">题目链接&lt;/a>&lt;/p>
&lt;h1 id="题意">题意：&lt;/h1>
&lt;p>求f[n] = f[n-1] + f[n-2] + 1，在b(10000)进制下的最后一位数字的十进制表示。&lt;/p>
&lt;h1 id="思路">思路：&lt;/h1>
&lt;p>构造矩阵即可，M矩阵是一个3_3的矩阵，M1矩阵是一个3_1的矩阵。。很easy，就不说了。&lt;/p></description></item><item><title>hdu 4686 Arc of Dream (构造矩阵，快速幂)</title><link>https://111qqz.com/2017/10/hdu-4686/</link><pubDate>Sun, 01 Oct 2017 06:33:48 +0000</pubDate><guid>https://111qqz.com/2017/10/hdu-4686/</guid><description>
&lt;p>&lt;a href="http://acm.hdu.edu.cn/showproblem.php?pid=4686">hdu4686题目链接&lt;/a>&lt;/p>
&lt;h1 id="题意">题意：&lt;/h1>
&lt;p>An Arc of Dream is a curve defined by following function:&lt;/p>
&lt;p>
&lt;img class="image_figure image_external" loading="lazy" src="https://odzkskevi.qnssl.com/5bb0e0e69de61a673fbd079520fe97e2?v=1506621126" alt="" />
&lt;/p>
&lt;p>where
a 0 = A0
a i = a i-1_AX+AY
b 0 = B0
b i = b i-1_BX+BY
What is the value of AoD(N) modulo 1,000,000,007?&lt;/p>
&lt;h1 id="思路">思路：&lt;/h1>
&lt;p>看n的1E18的范围也知道是矩阵快速幂。。&lt;/p>
&lt;p>难点还是构造矩阵。&lt;/p></description></item><item><title>uva 10870 - Recurrences (矩阵加速线性递推式)</title><link>https://111qqz.com/2017/10/uva-10870/</link><pubDate>Sat, 30 Sep 2017 20:35:55 +0000</pubDate><guid>https://111qqz.com/2017/10/uva-10870/</guid><description>
&lt;p>&lt;a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;amp;Itemid=8&amp;amp;page=show_problem&amp;amp;problem=1811">uva10870题目链接&lt;/a>&lt;/p>
&lt;h1 id="题意">题意：&lt;/h1>
&lt;p>f(n) = a1f(n − 1) + a2f(n − 2) + a3f(n − 3) + . . . + adf(n − d), for n &amp;gt; d&lt;/p>
&lt;p>给出f[1]..f[d],a[1]..a[d],问 f[n]%m是多少。&lt;/p>
&lt;h1 id="思路">思路：&lt;/h1>
&lt;p>构造矩阵，加速递推式。&lt;/p></description></item><item><title>uva 10655 - Contemplation! Algebra （构造矩阵，快速幂）</title><link>https://111qqz.com/2017/10/uva-10655/</link><pubDate>Sat, 30 Sep 2017 19:40:15 +0000</pubDate><guid>https://111qqz.com/2017/10/uva-10655/</guid><description>
&lt;p>&lt;a href="https://uva.onlinejudge.org/index.php?option=com_onlinejudge&amp;amp;Itemid=8&amp;amp;page=show_problem&amp;amp;problem=1596">uva10655题目链接&lt;/a>&lt;/p>
&lt;h1 id="题意">题意：&lt;/h1>
&lt;p>给出a+b和ab的值，问a^n+b^n&lt;/p>
&lt;h1 id="思路">思路：&lt;/h1>
&lt;p>构造矩阵,手写一下很显然&amp;hellip;&lt;/p>
&lt;p>转移矩阵M=[0 , 1]&lt;/p>
&lt;p>[-q,p ]&lt;/p>
&lt;p>初始矩阵M1=[p           ]&lt;/p>
&lt;p>[p^2-2*q]&lt;/p>
&lt;p>快速幂即可。&lt;/p>
&lt;p>&lt;strong>有个坑点在于..读入的结束是p=0&amp;amp;q=0,并且只有这两个输入。&lt;/strong>&lt;/p></description></item><item><title>【dp专题001】bzoj 1009: [HNOI2008]GT考试 (字符串上dp+kmp+矩阵加速线性递推式)</title><link>https://111qqz.com/2016/11/bzoj-1009/</link><pubDate>Sun, 13 Nov 2016 07:21:02 +0000</pubDate><guid>https://111qqz.com/2016/11/bzoj-1009/</guid><description>
&lt;h2 id="1009-hnoi2008gt考试">1009: [HNOI2008]GT考试&lt;/h2>
&lt;p>Time Limit: 1 Sec  Memory Limit: 162 MB
Submit: 3127  Solved: 1926
[&lt;a href="http://www.lydsy.com/JudgeOnline/submitpage.php?id=1009">Submit&lt;/a>][&lt;a href="http://www.lydsy.com/JudgeOnline/problemstatus.php?id=1009">Status&lt;/a>][&lt;a href="http://www.lydsy.com/JudgeOnline/bbs.php?id=1009">Discuss&lt;/a>]&lt;/p>
&lt;h2 id="description">Description&lt;/h2>
&lt;p>　　阿申准备报名参加GT考试，准考证号为N位数X1X2&amp;hellip;.Xn(0&amp;lt;=Xi&amp;lt;=9),他不希望准考证号上出现不吉利的数字。
他的不吉利数学A1A2&amp;hellip;Am(0&amp;lt;=Ai&amp;lt;=9)有M位，不出现是指X1X2&amp;hellip;Xn中没有恰好一段等于A1A2&amp;hellip;Am. A1和X1可以为
0&lt;/p></description></item><item><title>acdream oj 1124 喵喵的遗憾 (斐波那契数列循环节)</title><link>https://111qqz.com/2016/11/acdream-oj-1124--/</link><pubDate>Thu, 03 Nov 2016 00:39:54 +0000</pubDate><guid>https://111qqz.com/2016/11/acdream-oj-1124--/</guid><description>
&lt;p>&lt;a href="http://acdream.info/problem?pid=1124">题目链接&lt;/a>&lt;/p>
&lt;p>题意：&lt;/p>
&lt;p>
&lt;img class="image_figure image_external" loading="lazy" src="http://acdream.info/img/prob/1124/1.jpeg" alt="" />
&lt;/p>
&lt;p>F0 = 1 , F1 = 1 , F2 = 2 , Fn = Fn-1+Fn-2&lt;/p>
&lt;p>求：&lt;/p>
&lt;p>FFFn Mod P&lt;/p>
&lt;p>( 也就是 F[ F[ F[n] ] ]  % P )&lt;/p>
&lt;p>思路：原来这是适牛出的题2333.&lt;/p>
&lt;p>需要注意的是p可能为1，因此n==0或者1的时候，特判要输出1%p而不是1.&lt;/p></description></item><item><title>hdu 4291 A Short problem (矩阵快速幂+广义斐波那契循环节||暴力找循环节)</title><link>https://111qqz.com/2016/10/hdu-4291/</link><pubDate>Mon, 31 Oct 2016 08:59:53 +0000</pubDate><guid>https://111qqz.com/2016/10/hdu-4291/</guid><description>
&lt;p>&lt;a href="http://acm.hdu.edu.cn/showproblem.php?pid=4291">题目链接&lt;/a>&lt;/p>
&lt;p>题意：&lt;/p>
&lt;p>Given n (1 &amp;lt;= n &amp;lt;= 1018), You should solve for&lt;/p>
&lt;p>g(g(g(n))) mod 109 + 7
where&lt;/p>
&lt;p>g(n) = 3g(n - 1) + g(n - 2)&lt;/p>
&lt;p>g(1) = 1&lt;/p>
&lt;p>g(0) = 0思路：找循环节。首先由于模数固定，可以暴力一下找到循环节。&lt;/p>
&lt;p>得到1E9+7的循环节是222222224,222222224的循环节是183120.&lt;/p></description></item><item><title>hdu 1005 Number Sequence (矩阵快速幂加速线性递推式)</title><link>https://111qqz.com/2016/10/hdu-1005/</link><pubDate>Sun, 30 Oct 2016 21:18:36 +0000</pubDate><guid>https://111qqz.com/2016/10/hdu-1005/</guid><description>
&lt;p>&lt;a href="http://acm.hdu.edu.cn/showproblem.php?pid=1005">题目链接&lt;/a>&lt;/p>
&lt;p>题意：A number sequence is defined as follows:&lt;/p>
&lt;p>f(1) = 1, f(2) = 1, f(n) = (A * f(n - 1) + B * f(n - 2)) mod 7.&lt;/p>
&lt;p>Given A, B, and n, you are to calculate the value of f(n).&lt;/p>
&lt;p>思路：矩阵加速线性递推式。&lt;/p>
&lt;p>这题第一次看是2012年11月2333，当时用pascal写的&lt;/p></description></item><item><title>hdu 3221 Brute-force Algorithm (矩阵快速幂+指数循环节)</title><link>https://111qqz.com/2016/10/hdu-3221/</link><pubDate>Sun, 30 Oct 2016 16:45:32 +0000</pubDate><guid>https://111qqz.com/2016/10/hdu-3221/</guid><description>
&lt;p>&lt;a href="http://acm.hdu.edu.cn/showproblem.php?pid=3221">题目链接&lt;/a>&lt;/p>
&lt;p>题意：给出了一段伪代码。分析得知其实就是f[1]= a,f[2] = b,f[n]=f[n-1] * f[n-2]&lt;/p>
&lt;p>思路：一眼题，和hdu4549很类似&lt;a href="https://111qqz.com/2016/10/hdu4549/">hdu4549解题报告&lt;/a>&lt;/p>
&lt;p>不同的是这道题中p不一定是质数（其实不是也无所谓啊&amp;hellip;hdu4549只不过是因为1E9+7是指数，又用费马小定理化简了一下,这道理%phi(p)即可）&lt;/p></description></item><item><title>BZOJ 4547: Hdu5171 小奇的集合 (矩阵快速幂)</title><link>https://111qqz.com/2016/10/bzoj-4547-hdu5171--/</link><pubDate>Wed, 26 Oct 2016 01:09:38 +0000</pubDate><guid>https://111qqz.com/2016/10/bzoj-4547-hdu5171--/</guid><description>
&lt;h2 id="4547-hdu5171-小奇的集合">4547: Hdu5171 小奇的集合&lt;/h2>
&lt;p>Time Limit: 2 Sec  Memory Limit: 256 MB
Submit: 263  Solved: 113
[&lt;a href="http://www.lydsy.com/JudgeOnline/submitpage.php?id=4547">Submit&lt;/a>][&lt;a href="http://www.lydsy.com/JudgeOnline/problemstatus.php?id=4547">Status&lt;/a>][&lt;a href="http://www.lydsy.com/JudgeOnline/bbs.php?id=4547">Discuss&lt;/a>]&lt;/p>
&lt;h2 id="description">Description&lt;/h2>
&lt;p> 有一个大小为n的可重集S，小奇每次操作可以加入一个数a+b(a,b均属于S)，求k次操作后它可获得的S的和的最大&lt;/p></description></item><item><title>hdu 5171 GTY's birthday gift (矩阵快速幂)</title><link>https://111qqz.com/2016/10/hdu-5171-gtys-birthday-gift-/</link><pubDate>Tue, 25 Oct 2016 10:56:10 +0000</pubDate><guid>https://111qqz.com/2016/10/hdu-5171-gtys-birthday-gift-/</guid><description>
&lt;p>&lt;a href="http://acm.hdu.edu.cn/showproblem.php?pid=5171">题目链接&lt;/a>&lt;/p>
&lt;p>题意：给出n,k，以及n个正数，把n个数放在一个集合里，进行k次操作，每次操作取最大的数和次大的数放进集合。问k次操作结束后，集合中所有数的和。&lt;/p></description></item><item><title>hdu 4965 Fast Matrix Calculation (矩阵快速幂，2014多校#9)</title><link>https://111qqz.com/2016/10/hdu-4965-fast-matrix-calculation-20149/</link><pubDate>Wed, 19 Oct 2016 20:54:11 +0000</pubDate><guid>https://111qqz.com/2016/10/hdu-4965-fast-matrix-calculation-20149/</guid><description>
&lt;p>题目链接&lt;/p>
&lt;p>题意：Step 1: Calculate a new N&lt;em>N matrix C = A&lt;/em>B.
Step 2: Calculate M = C^(N*N).
Step 3: For each element x in M, calculate x % 6. All the remainders form a new matrix M’.
Step 4: Calculate the sum of all the elements in M’.&lt;/p>
&lt;p>思路： 水题。。就一个trick&amp;hellip;&lt;/p></description></item><item><title>hdu 2157 How many ways?? (矩阵快速幂经典题目)</title><link>https://111qqz.com/2016/10/hdu-2157/</link><pubDate>Wed, 19 Oct 2016 12:36:20 +0000</pubDate><guid>https://111qqz.com/2016/10/hdu-2157/</guid><description>
&lt;p>题意：&lt;strong>给定一个有向图，问从A点恰好走k步（允许重复经过边）到达B点的方案数mod p的值&lt;/strong>&lt;/p>
&lt;p>思路：
** 把给定的图转为邻接矩阵，即A(i,j)=1当且仅当存在一条边i-&amp;gt;j。令C=A*A，那么C(i,j)=ΣA(i,k)&lt;em>A(k,j)，实际上就等于从点i到点j恰好经过2条边的路径数（枚举k为中转点）。类似地，C&lt;/em>A的第i行第j列就表示从i到j经过3条边的路径数。同理，如果要求经过k步的路径数，我们只需要快速幂求出A^k即可。**&lt;/p></description></item><item><title>poj 3233 Matrix Power Series （矩阵快速幂+分治）</title><link>https://111qqz.com/2016/10/poj-3233/</link><pubDate>Wed, 19 Oct 2016 08:17:04 +0000</pubDate><guid>https://111qqz.com/2016/10/poj-3233/</guid><description>
&lt;p>&lt;a href="http://poj.org/problem?id=3233">题目链接&lt;/a>&lt;/p>
&lt;p>题意：&lt;/p>
&lt;p>Given a &lt;em>n&lt;/em> × &lt;em>n&lt;/em> matrix &lt;em>A&lt;/em> and a positive integer &lt;em>k&lt;/em>, find the sum &lt;em>S&lt;/em> = &lt;em>A&lt;/em> + _A_2 + _A_3 + … + &lt;em>Ak&lt;/em>.&lt;/p>
&lt;p>思路： 对k进行二分。&lt;/p>
&lt;p>比如，当k=6时，有：
A + A^2 + A^3 + A^4 + A^5 + A^6 =&lt;em>(A + A^2 + A^3)&lt;/em> + A^3*&lt;em>(A + A^2 + A^3)&lt;/em>
应用这个式子后，规模k减小了一半。我们二分求出A^3后再递归地计算A + A^2 + A^3，即可得到原问题的答案。&lt;/p></description></item><item><title>poj 3070 Fibonacci (矩阵加速线性递推式)</title><link>https://111qqz.com/2016/10/poj-3070-fibonacci/</link><pubDate>Mon, 17 Oct 2016 18:36:15 +0000</pubDate><guid>https://111qqz.com/2016/10/poj-3070-fibonacci/</guid><description>
&lt;p>&lt;a href="http://poj.org/problem?id=3070">题目链接&lt;/a>&lt;/p>
&lt;p>题意：求f[n] % 10000,f为斐波那契数。&lt;/p>
&lt;p>思路：按照题目给出的公式，或者按照加速线性递推式的方法都可以。。。&lt;/p>
&lt;p>因为把模数的1E4手滑写成1E4+7结果调了半天也是没谁了呵呵呵呵。&lt;/p></description></item><item><title>矩阵加速线性递推式（转载）</title><link>https://111qqz.com/2016/10/</link><pubDate>Mon, 17 Oct 2016 17:38:36 +0000</pubDate><guid>https://111qqz.com/2016/10/</guid><description>
&lt;p>找到了篇四年前空间中的旧文，也是有点感动2333.&lt;/p>
&lt;!-- more -->
&lt;h2 id="快速求解多项递推式">快速求解多项递推式&lt;/h2>
&lt;p>问题描述:&lt;/p>
&lt;p>已知 F(n) = AF(n-1) + BF(n-2) + CF(n-3)+&amp;hellip;..&lt;/p>
&lt;p>求解 F(n)%P&lt;/p>
&lt;p>分析:&lt;/p>
&lt;p>＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊＊&lt;/p></description></item><item><title>矩阵学习笔记</title><link>https://111qqz.com/2016/10/</link><pubDate>Mon, 17 Oct 2016 17:03:16 +0000</pubDate><guid>https://111qqz.com/2016/10/</guid><description>
&lt;p>参考资料：&lt;/p>
&lt;p>&lt;a href="http://www.matrix67.com/blog/archives/276">十个利用矩阵乘法解决的经典题目&lt;/a>&lt;/p></description></item><item><title>hdu 1575 Tr A （矩阵快速幂模板题）</title><link>https://111qqz.com/2016/02/hdu1575/</link><pubDate>Sun, 21 Feb 2016 03:21:51 +0000</pubDate><guid>https://111qqz.com/2016/02/hdu1575/</guid><description>
&lt;p>&lt;a href="http://acm.hdu.edu.cn/showproblem.php?pid=1575">http://acm.hdu.edu.cn/showproblem.php?pid=1575&lt;/a>&lt;/p>
&lt;p>题意：A为一方阵，求(A^k)73得到的矩阵的主对角线的和。&lt;/p>
&lt;p>思路：矩阵快速幂。模板题。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-cpp" data-lang="cpp">&lt;span class="line">&lt;span class="ln"> 1&lt;/span>&lt;span class="cl">&lt;span class="cm">/* ***********************************************
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 2&lt;/span>&lt;span class="cl">&lt;span class="cm">Author :111qqz
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 3&lt;/span>&lt;span class="cl">&lt;span class="cm">Created Time :2016年02月21日 星期日 10时28分33秒
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 4&lt;/span>&lt;span class="cl">&lt;span class="cm">File Name :code/hdu/1575.cpp
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 5&lt;/span>&lt;span class="cl">&lt;span class="cm">************************************************ */&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 6&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 7&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;cstdio&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 8&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;cstring&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 9&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;iostream&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 10&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;algorithm&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 11&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;vector&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 12&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;queue&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 13&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;set&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 14&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;map&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 15&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;string&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 16&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;cmath&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 17&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;cstdlib&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 18&lt;/span>&lt;span class="cl">&lt;span class="cp">#include&lt;/span> &lt;span class="cpf">&amp;lt;ctime&amp;gt;&lt;/span>&lt;span class="cp">
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 19&lt;/span>&lt;span class="cl">&lt;span class="cp">#define fst first
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 20&lt;/span>&lt;span class="cl">&lt;span class="cp">#define sec second
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 21&lt;/span>&lt;span class="cl">&lt;span class="cp">#define lson l,m,rt&amp;lt;&amp;lt;1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 22&lt;/span>&lt;span class="cl">&lt;span class="cp">#define rson m+1,r,rt&amp;lt;&amp;lt;1|1
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 23&lt;/span>&lt;span class="cl">&lt;span class="cp">#define ms(a,x) memset(a,x,sizeof(a))
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 24&lt;/span>&lt;span class="cl">&lt;span class="cp">&lt;/span>&lt;span class="k">typedef&lt;/span> &lt;span class="kt">long&lt;/span> &lt;span class="kt">long&lt;/span> &lt;span class="n">LL&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 25&lt;/span>&lt;span class="cl">&lt;span class="cp">#define pi pair &amp;lt; int ,int &amp;gt;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 26&lt;/span>&lt;span class="cl">&lt;span class="cp">#define MP make_pair
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 27&lt;/span>&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 28&lt;/span>&lt;span class="cl">&lt;span class="k">using&lt;/span> &lt;span class="k">namespace&lt;/span> &lt;span class="n">std&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 29&lt;/span>&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">double&lt;/span> &lt;span class="n">eps&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">1E-8&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 30&lt;/span>&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">dx4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 31&lt;/span>&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">dy4&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="mi">4&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">{&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">-&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">};&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 32&lt;/span>&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">inf&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mh">0x3f3f3f3f&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 33&lt;/span>&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">N&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="mi">12&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 34&lt;/span>&lt;span class="cl">&lt;span class="k">const&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">MOD&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">9973&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 35&lt;/span>&lt;span class="cl">&lt;span class="k">struct&lt;/span> &lt;span class="nc">Mat&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 36&lt;/span>&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 37&lt;/span>&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">N&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">N&lt;/span>&lt;span class="p">];&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 38&lt;/span>&lt;span class="cl"> &lt;span class="kt">void&lt;/span> &lt;span class="nf">clear&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 39&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 40&lt;/span>&lt;span class="cl"> &lt;span class="n">ms&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="mi">0&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 41&lt;/span>&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 42&lt;/span>&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 43&lt;/span>&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 44&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 45&lt;/span>&lt;span class="cl">&lt;span class="n">Mat&lt;/span> &lt;span class="k">operator&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Mat&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">Mat&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 46&lt;/span>&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 47&lt;/span>&lt;span class="cl"> &lt;span class="n">Mat&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 48&lt;/span>&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">clear&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 49&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 50&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 51&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">k&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">k&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">k&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 52&lt;/span>&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">]&lt;/span> &lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">+&lt;/span>&lt;span class="n">a&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">*&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="n">MOD&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 53&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 54&lt;/span>&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 55&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 56&lt;/span>&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 57&lt;/span>&lt;span class="cl">&lt;span class="n">Mat&lt;/span> &lt;span class="k">operator&lt;/span> &lt;span class="o">^&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">Mat&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="kt">int&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 58&lt;/span>&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 59&lt;/span>&lt;span class="cl"> &lt;span class="n">Mat&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 60&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 61&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span>&lt;span class="o">++&lt;/span> &lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 62&lt;/span>&lt;span class="cl"> &lt;span class="n">c&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">]&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">==&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 63&lt;/span>&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 64&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 65&lt;/span>&lt;span class="cl"> &lt;span class="k">if&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">b&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">c&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 66&lt;/span>&lt;span class="cl"> &lt;span class="n">b&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">b&lt;/span>&lt;span class="o">&amp;gt;&amp;gt;&lt;/span>&lt;span class="mi">1&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 67&lt;/span>&lt;span class="cl"> &lt;span class="n">a&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">a&lt;/span> &lt;span class="o">*&lt;/span> &lt;span class="n">a&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 68&lt;/span>&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 69&lt;/span>&lt;span class="cl"> &lt;span class="k">return&lt;/span> &lt;span class="n">c&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 70&lt;/span>&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 71&lt;/span>&lt;span class="cl">&lt;span class="kt">int&lt;/span> &lt;span class="nf">main&lt;/span>&lt;span class="p">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 72&lt;/span>&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 73&lt;/span>&lt;span class="cl"> &lt;span class="cp">#ifndef ONLINE_JUDGE
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 74&lt;/span>&lt;span class="cl">&lt;span class="cp">&lt;/span> &lt;span class="n">freopen&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;code/in.txt&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="s">&amp;#34;r&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">stdin&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 75&lt;/span>&lt;span class="cl"> &lt;span class="cp">#endif
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 76&lt;/span>&lt;span class="cl">&lt;span class="cp">&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 77&lt;/span>&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">T&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 78&lt;/span>&lt;span class="cl"> &lt;span class="n">scanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%d&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 79&lt;/span>&lt;span class="cl"> &lt;span class="k">while&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">T&lt;/span>&lt;span class="o">--&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 80&lt;/span>&lt;span class="cl"> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 81&lt;/span>&lt;span class="cl"> &lt;span class="n">scanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%d %d&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">n&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 82&lt;/span>&lt;span class="cl"> &lt;span class="n">A&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">clear&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 83&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 84&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span>&lt;span class="p">;&lt;/span> &lt;span class="n">j&lt;/span> &lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 85&lt;/span>&lt;span class="cl"> &lt;span class="n">scanf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%d&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="n">A&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">j&lt;/span>&lt;span class="p">]);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 86&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 87&lt;/span>&lt;span class="cl"> &lt;span class="n">Mat&lt;/span> &lt;span class="n">res&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 88&lt;/span>&lt;span class="cl"> &lt;span class="n">res&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">clear&lt;/span>&lt;span class="p">();&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 89&lt;/span>&lt;span class="cl"> &lt;span class="n">res&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">A&lt;/span>&lt;span class="o">^&lt;/span>&lt;span class="n">k&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 90&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 91&lt;/span>&lt;span class="cl"> &lt;span class="kt">int&lt;/span> &lt;span class="n">ans&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 92&lt;/span>&lt;span class="cl"> &lt;span class="k">for&lt;/span> &lt;span class="p">(&lt;/span> &lt;span class="kt">int&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">0&lt;/span> &lt;span class="p">;&lt;/span> &lt;span class="n">i&lt;/span> &lt;span class="o">&amp;lt;&lt;/span> &lt;span class="n">n&lt;/span> &lt;span class="p">;&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="o">++&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="n">ans&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">ans&lt;/span> &lt;span class="o">+&lt;/span>&lt;span class="n">res&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">mat&lt;/span>&lt;span class="p">[&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">][&lt;/span>&lt;span class="n">i&lt;/span>&lt;span class="p">])&lt;/span>&lt;span class="o">%&lt;/span>&lt;span class="n">MOD&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 93&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 94&lt;/span>&lt;span class="cl"> &lt;span class="n">printf&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s">&amp;#34;%d&lt;/span>&lt;span class="se">\n&lt;/span>&lt;span class="s">&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>&lt;span class="n">ans&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 95&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 96&lt;/span>&lt;span class="cl"> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 97&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 98&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 99&lt;/span>&lt;span class="cl"> &lt;span class="cp">#ifndef ONLINE_JUDGE
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">100&lt;/span>&lt;span class="cl">&lt;span class="cp">&lt;/span> &lt;span class="n">fclose&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">stdin&lt;/span>&lt;span class="p">);&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">101&lt;/span>&lt;span class="cl"> &lt;span class="cp">#endif
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">102&lt;/span>&lt;span class="cl">&lt;span class="cp">&lt;/span> &lt;span class="k">return&lt;/span> &lt;span class="mi">0&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">103&lt;/span>&lt;span class="cl">&lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item><item><title>codeforces #341 div 2 E. Wet Shark and Blocks (数位dp+矩阵加速)</title><link>https://111qqz.com/2016/02/cf621e/</link><pubDate>Mon, 08 Feb 2016 09:04:41 +0000</pubDate><guid>https://111qqz.com/2016/02/cf621e/</guid><description>
&lt;h3>&lt;a href="http://codeforces.com/problemset/problem/621/E">http://codeforces.com/problemset/problem/621/E&lt;/a>&lt;/h3>
&lt;p>题意：有b组数，每组数均有n个且相同。你必须在每组选一个数，组成一个新数sum，使得sum % x == k，问方案数 % (1e9+7)。&lt;/p>
&lt;p>思路：数位dp.首先考虑b不是很大的一般情况。dp[i][j]表示处理到前i个块的时候结果为j的方案数。那么转移方程就是：**dp[i][(j_10+t)%x] = dp[i-1][j]_cnt[t] ** cnt[i]表示数字i出现的个数。&lt;/p></description></item></channel></rss>