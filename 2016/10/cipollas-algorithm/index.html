<!doctype html><html lang=zh-cn><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta property="og:site_name" content="111qqz的小窝"><meta property="og:type" content="article"><meta property="og:image" content="https://111qqz.github.io/img/2.png"><meta property="twitter:image" content="https://111qqz.github.io/img/2.png"><meta name=title content="二次剩余（Cipolla's algorithm）学习笔记"><meta property="og:title" content="二次剩余（Cipolla's algorithm）学习笔记"><meta property="twitter:title" content="二次剩余（Cipolla's algorithm）学习笔记"><meta name=description content><meta property="og:description" content><meta property="twitter:description" content><meta property="twitter:card" content="summary"><meta name=keyword content="ACM,111qqz,商汤科技,hust,华中科技大学"><link rel="shortcut icon" href=/img/favicon.ico><title>二次剩余（Cipolla's algorithm）学习笔记-111qqz的小窝</title><link rel=canonical href=/2016/10/cipollas-algorithm/><link rel=stylesheet href=/css/iDisqus.min.css><link rel=stylesheet href=/css/bootstrap.min.css><link rel=stylesheet href=/css/hux-blog.min.css><link rel=stylesheet href=/css/syntax.css><link rel=stylesheet href=/css/zanshang.css><link href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css rel=stylesheet type=text/css><script src=/js/jquery.min.js></script><script src=/js/bootstrap.min.js></script><script src=/js/hux-blog.min.js></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/styles/docco.min.css><script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.13.1/highlight.min.js></script><script>hljs.initHighlightingOnLoad();</script><link rel=stylesheet href=/css/hux-blog.min.css><link rel=stylesheet href=/css/hux-blog.min-custom.css></head><nav class="navbar navbar-default navbar-custom navbar-fixed-top"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span><span class=icon-bar></span><span class=icon-bar></span></button>
<a class=navbar-brand href=/>111qqz的小窝</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=/>Home</a></li><li><a href=/categories/acm/>ACM-ICPC</a></li><li><a href=/categories/deep-learning/>深度学习</a></li><li><a href=/categories/mooc/>公开课</a></li><li><a href=/categories/%e5%85%b6%e4%bb%96/>其他</a></li><li><a href=/top/about/>ABOUT</a></li><li><a href=/search>SEARCH <img src=/img/search.png height=15 style=cursor:pointer alt=Search></a></li></ul></div></div></div></nav><script>var $body=document.body;var $toggle=document.querySelector('.navbar-toggle');var $navbar=document.querySelector('#huxblog_navbar');var $collapse=document.querySelector('.navbar-collapse');$toggle.addEventListener('click',handleMagic)
function handleMagic(e){if($navbar.className.indexOf('in')>0){$navbar.className=" ";setTimeout(function(){if($navbar.className.indexOf('in')<0){$collapse.style.height="0px"}},400)}else{$collapse.style.height="auto"
$navbar.className+=" in";}}</script><style type=text/css>header.intro-header{background-image:url(/img/2.png)}</style><header class=intro-header><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/tags/number-theory title="number theory">number theory</a>
<a class=tag href=/tags/%E4%BA%8C%E6%AC%A1%E5%89%A9%E4%BD%99 title=二次剩余>二次剩余</a>
<a class=tag href=/tags/%E5%89%A9%E4%BD%99%E7%B3%BB title=剩余系>剩余系</a></div><h1>二次剩余（Cipolla's algorithm）学习笔记</h1><h2 class=subheading></h2><span class=meta>Posted by
111qqz
on
Monday, October 10, 2016
<span id=/2016/10/cipollas-algorithm/ class="leancloud_visitors meta_data_item" data-flag-title><span class=post-meta-item-icon><span class="octicon octicon-eye"></span></span><i class="fa fa-eye"></i><span class=old-visitors-count style=display:none></span><span class=leancloud-visitors-count></span></span><script src=https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js></script><script>AV.initialize("2dzJwxGKq4hbtg5R5NM8NTzJ-gzGzoHsz","RaYu8uGTiuiIjLISQppPVYWw");</script><script type=text/javascript>function showTime(Counter){var query=new AV.Query(Counter);var entries=[];var $visitors=$(".leancloud_visitors");$visitors.each(function(){entries.push($(this).attr("id").trim());});query.containedIn('url',entries);query.find().done(function(results){var COUNT_CONTAINER_REF='.leancloud-visitors-count';var OLD_COUNT_CONTAINER_REF='.old-visitors-count';for(var i=0;i<results.length;i++){var item=results[i];var url=item.get('url');var time=item.get('time');var element=document.getElementById(url);$(element).find(COUNT_CONTAINER_REF).text(time);}
for(var i=0;i<entries.length;i++){var url=entries[i];var element=document.getElementById(url);var countSpan=$(element).find(COUNT_CONTAINER_REF);if(countSpan.text()==''){var oldCountSpan=$(element).find(OLD_COUNT_CONTAINER_REF).text();if(oldCountSpan!=''){countSpan.text(0+parseInt(oldCountSpan));}else{countSpan.text(0);}}}}).fail(function(object,error){console.log("Error: "+error.code+" "+error.message);});}
function addCount(Counter){var $visitors=$(".leancloud_visitors");var url=$visitors.attr('id').trim();var title=$visitors.attr('data-flag-title').trim();var query=new AV.Query(Counter);query.equalTo("url",url);query.find({success:function(results){if(results.length>0){var counter=results[0];counter.fetchWhenSave(true);counter.increment("time");counter.save(null,{success:function(counter){var $element=$(document.getElementById(url));$element.find('.leancloud-visitors-count').text(counter.get('time'));},error:function(counter,error){console.log('Failed to save Visitor num, with error message: '+error.message);}});}else{var newcounter=new Counter();var acl=new AV.ACL();acl.setPublicReadAccess(true);acl.setPublicWriteAccess(true);newcounter.setACL(acl);newcounter.set("title",title);newcounter.set("url",url);var OLD_COUNT_CONTAINER_REF='.old-visitors-count';var $element=$(document.getElementById(url));var oldCountSpan=$element.find(OLD_COUNT_CONTAINER_REF).text();if(oldCountSpan!=''){newcounter.set("time",parseInt(oldCountSpan)+1);}else{newcounter.set("time",1);}
newcounter.save(null,{success:function(newcounter){var $element=$(document.getElementById(url));$element.find('.leancloud-visitors-count').text(newcounter.get('time'));},error:function(newcounter,error){console.log('Failed to create');}});}},error:function(error){console.log('Error:'+error.code+" "+error.message);}});}
$(function(){var Counter=AV.Object.extend("Counter");if($('.leancloud_visitors').length==1){addCount(Counter);}else{showTime(Counter);}});</script></span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><header><h2>TOC</h2></header><nav id=TableOfContents><ol><li><ol><li><a href=#前置技能点>前置技能点：</a></li><li><a href=#正片>正片：</a></li><li><a href=#例子一对于给定数寻找其为二次剩余的模数>例子一：对于给定数，寻找其为二次剩余的模数</a></li><li><a href=#heading></a></li><li><a href=#例子二对指定的质数_p_寻找其二次剩余>**例子二：对指定的质数_p_，寻找其二次剩余**</a></li></ol></li></ol></nav><p>先放资料。</p><hr><h3 id=前置技能点><strong>前置技能点：</strong></h3><p><a href="http://baike.baidu.com/link?url=7nEL8QRUFHmQQor4elIUVpLVJG0i63Q3iRRXhrzzr1p2bhJ4qq4d-whxKrZhx6O8GEBf_iv_wsM2bWH1NJaJDVyLM8Mft0PCPAhMnYj6eNG2zh4lTNt5YvGDn1R4vrYE">剩余系</a></p><blockquote><blockquote><p><strong>剩余系</strong>**:****设模为****m,****则根据余数可将所有的整数分成****m****类，分别记成****[0],[1],[2],****…****[m-1]****，**</p></blockquote><blockquote><p><strong>这<strong><strong>m</strong></strong>个数</strong>**{0,1,2,****…****m-1}****称为一个完全剩余系，**</p></blockquote><blockquote><p><strong>每个数称为相应类的代表元。</strong></p></blockquote><blockquote><p>当m=10（偶数）时候，则{0,1,2,3,4,5,6,7,8,9}是最小非负完全剩余系</p></blockquote><blockquote><p>{-5,-4,-3,-2,-1,0,1,2,3,4,5} 是绝对值最小完全剩余系</p></blockquote><blockquote><p>{-4,-3,-2,-1,0,1,2,3,4,5} 绝对值最小</p></blockquote><blockquote><p>{1,2,3,4,5,6,7,8,9,10}是最小正完全剩余系</p></blockquote><blockquote></blockquote><blockquote></blockquote><blockquote></blockquote><blockquote><p><strong>简化剩余系:在每个剩余类选取至1个与m互素代表元构成简化剩余系。</strong></p></blockquote><blockquote><p>当m=10则,{0,1,2,3,4,5,6,7,8,9} 完全剩余系</p></blockquote><blockquote><p>{1,3,7,9}是简化剩余系(x,10)=1</p></blockquote><blockquote><p>当m=5则，{0,1,2,3,4}为完全剩余系,</p></blockquote><blockquote><p>{1,2,3,4}是简化剩余系，因为除去余0(正好是倍数)外，其它都互素。</p></blockquote><blockquote><p><strong>f(m)=欧拉函数=|{t|0&lt;t&lt;m, (t, m)=1}|</strong></p></blockquote><blockquote><p><strong>=简化剩余系的元素个数</strong></p></blockquote><blockquote></blockquote></blockquote><p><a href=https://zh.wikipedia.org/wiki/>维基百科_高斯引理</a></p><blockquote>设_p_为奇[质数](https://zh.wikipedia.org/wiki/)，_a_是一个与_p_[互质](https://zh.wikipedia.org/wiki/)的整数。考虑以下数组：![{\displaystyle a,2a,3a,\dots ,{\frac {p-1}{2}}a}](https://wikimedia.org/api/rest_v1/media/math/render/svg/82941c63fd5e49cf0b57612ee5e895d1e1c9096c)
以及它们对_p_的[最小非负剩余](https://zh.wikipedia.org/w/index.php?title=&action=edit&redlink=1)。这些剩余两两不等（**kk:这些剩余两两不等的证明：可以考虑反证，假设两个不同的数x,y对于p同余， 那么x-y和0关于p同余，而x-y同时关于a同余，a与p互质，矛盾。因此这些剩余两两不等**），因此我们共有![\frac{p-1}{2}](https://wikimedia.org/api/rest_v1/media/math/render/svg/a733b8495b0d55ed5bc9d795b7b6821efb1d858b)
个两两不等的介于1和_p（_**kk:这里似乎有问题，如果剩余是在1..p之间，那么前面应该是说最小正剩余而不是最小非负剩余，最小非负剩余应该是在0..p-1之间**_）_之间的整数：![{\displaystyle t_{1},t_{2},t_{3},\dots ,t_{\frac {p-1}{2}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/7992b0d1c192f11821dce891b5f16dffdb35c536)
。设其中有_n_个数比_p_/2大，那么高斯引理声称：![{\displaystyle \left({\frac {a}{p}}\right)=(-1)^{n}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/1b89fef980b3b0a785356b6960fd49e257aa2b16)<p>上式左边是<a href=https://zh.wikipedia.org/wiki/>勒让德符号</a>，当其值为+1时，表示_a_是模_p_的二次剩余；其值为-1时，表示_a_是模_p_的二次非剩余。</p><p>用通俗的语言来说，就是：<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/7992b0d1c192f11821dce891b5f16dffdb35c536 alt="{\displaystyle t_{1},t_{2},t_{3},\dots ,t_{\frac {p-1}{2}}}">
里面比_p_/2大的有<a href=https://zh.wikipedia.org/wiki/>偶数</a>个，那么_a_是模_p_的二次剩余，如果有<a href=https://zh.wikipedia.org/wiki/>奇数</a>个，那么_a_是模_p_的二次非剩余。</blockquote></p><hr><h3 id=正片><strong>正片：</strong></h3><p><a href=https://zh.wikipedia.org/wiki/>维基百科_勒让德符号</a></p><p>定义：</p><blockquote>勒让德符号![({\tfrac {a}{p}})](https://wikimedia.org/api/rest_v1/media/math/render/svg/6ebb252decd96b7adf4d3fffdda2c15b718c7420)
（有时为了印刷上的方便，写成(_a_|_p_))有下列定义：<blockquote></blockquote><table border=0><tbody><tr><blockquote><td rowspan=3>![\left({\frac {a}{p}}\right)={\begin{cases}\quad 0\\+1\\-1\end{cases}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/ddbfff4690a7d39fe7c2fcd69885dc8f36f2ed7c)</blockquote><blockquote></td></blockquote><blockquote><td rowspan=3></td></blockquote><blockquote><td>如果![a\equiv 0{\pmod {p}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/30d65a6f62fe8c414ef6c4b123da631d1125594f)</blockquote><blockquote></td></blockquote></tr><tr><blockquote><td>如果![a\not \equiv 0{\pmod {p}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/520a34d8efca5436576b29f6765af091ad07b271)</blockquote><p>，且对于某个整数<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/065799916443b503df9e3adc2d007ccd5a1aafc4 alt="x,x^{2}\equiv \;a{\pmod {p}}"></p><blockquote></td></blockquote></tr><tr><blockquote><td>如果不存在整数![x](https://wikimedia.org/api/rest_v1/media/math/render/svg/87f9e315fd7e2ba406057a97300593c4802b53e4)</blockquote><p>，使得<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/787894eeb27239e1dfdbe6f6d8ba080dab3eeb73 alt="x^{2}\equiv \;a{\pmod {p}}">
。</p><blockquote></td></blockquote></tr></tbody></table><blockquote><p>如果(<em>a_|_p</em>) = 1，<em>a</em> 便称为<a href=https://zh.wikipedia.org/wiki/>二次剩余</a>(mod <em>p</em>)；如果(<em>a_|_p</em>) = −1，则 <em>a</em> 称为<a href=https://zh.wikipedia.org/wiki/>二次非剩余</a>(mod p)。通常把零视为一种特殊的情况。</blockquote></p></blockquote><p>性质：</p><blockquote>勒让德符号有许多有用的性质，可以用来加速计算。它们包括：<blockquote></blockquote><pre><code>  * ![\left({\frac {ab}{p}}\right)=\left({\frac {a}{p}}\right)\left({\frac {b}{p}}\right)](https://wikimedia.org/api/rest_v1/media/math/render/svg/0c8876ab646dd7c9976bc54dd7487527f77bd202)
</code></pre><p>（它是一个**<a href=https://zh.wikipedia.org/wiki/>完全积性函数</a>**(kk:g(a)*g(b)=g(a*b)对于任意正整数a,b都成立，不需要gcd(a,b)=1，完全积性真是爽哭了。。。。)。这个性质可以进一步理解为：两个剩余或非剩余的乘积是剩余，一个剩余与一个非剩余的乘积是非剩余。（kk:因为负负得正，正正得正&mldr;））</p><pre><code>  * 如果_a_ ≡ _b_ (mod _p_)，则![\left({\frac {a}{p}}\right)=\left({\frac {b}{p}}\right)](https://wikimedia.org/api/rest_v1/media/math/render/svg/22c53d660aed6373e99b8e0feb7d9801186b2d41)



  * ![\left({\frac {a^{2}}{p}}\right)=1](https://wikimedia.org/api/rest_v1/media/math/render/svg/d5b6f43df4f40202dbf365146ae39d7037387df5)



  * ![{\displaystyle \left({\frac {-1}{p}}\right)=(-1)^{\frac {p-1}{2}}={\begin{cases}+1{\mbox{ if }}p\equiv 1{\pmod {4}}\\-1{\mbox{ if }}p\equiv 3{\pmod {4}}\end{cases}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/dd3bcfb31b3ac3ef72a6838ba0d0c58a2f236f74)
</code></pre><p>这个性质称为二次互反律的第一补充。</p><pre><code>  * ![{\displaystyle \left({\frac {2}{p}}\right)=(-1)^{\frac {p^{2}-1}{8}}={\begin{cases}+1{\mbox{ if }}p\equiv 1{\mbox{ or }}7{\pmod {8}}\\-1{\mbox{ if }}p\equiv 3{\mbox{ or }}5{\pmod {8}}\end{cases}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/d90e3a78bfe75d1c4f4bfdd49690bd3af4673562)
</code></pre><p>这个性质称为二次互反律的第二补充。一般的二次互反律为：</p><pre><code>  * 如果_p_和_q_是奇素数，则![\left({\frac {q}{p}}\right)=\left({\frac {p}{q}}\right)(-1)^{{{\frac {p-1}{2}}{\frac {q-1}{2}}}}.](https://wikimedia.org/api/rest_v1/media/math/render/svg/966e6a0e5a66971e0c4d850b4a1627a598863d46)
</code></pre><p>参见<a href=https://zh.wikipedia.org/wiki/>二次互反律</a>和<a href="https://zh.wikipedia.org/w/index.php?title=&action=edit&redlink=1">二次互反律的证明</a>。</p><p>以下是一些较小的_p_的值的公式：</p><blockquote></blockquote><pre><code>  * 对于奇素数_p_，![\left({\frac {3}{p}}\right)=(-1)^{\left\lceil {\frac {p+1}{6}}\right\rceil }={\begin{cases}+1{\mbox{ if }}p\equiv 1{\mbox{ or }}11{\pmod {12}}\\-1{\mbox{ if }}p\equiv 5{\mbox{ or }}7{\pmod {12}}\end{cases}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/1d1c563452f82cfaf77baaecb82ed16888381a6b)



  * 对于奇素数_p_，![\left({\frac {5}{p}}\right)=(-1)^{\left\lfloor {\frac {p-2}{5}}\right\rfloor }={\begin{cases}+1{\mbox{ if }}p\equiv 1{\mbox{ or }}4{\pmod 5}\\-1{\mbox{ if }}p\equiv 2{\mbox{ or }}3{\pmod 5}\end{cases}},](https://wikimedia.org/api/rest_v1/media/math/render/svg/8e1ed5877d9a39798e4afdb699e61d13b8071e59)
</code></pre><p>但一般直接把剩余和非剩余列出更简便：</p><pre><code>  * 对于奇素数_p_，![\left({\frac {7}{p}}\right)={\begin{cases}+1{\mbox{ if }}p\equiv 1,3,9,19,25,{\mbox{ or }}27{\pmod {28}}\\-1{\mbox{ if }}p\equiv 5,11,13,15,17,{\mbox{ or }}23{\pmod {28}}\end{cases}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/a70b4a7cc4d99b0842fa9b6bc71209398f6f8eeb)
</code></pre><p>勒让德符号(<em>a_|_p</em>)是一个<a href=https://zh.wikipedia.org/wiki/>狄利克雷特征</a>(mod <em>p</em>)。</blockquote></p><p>计算勒让德符号的一个例子：</p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/827ce8eb12cd064d538fba78851cdcf32f5237e9 alt="\left({\frac {12345}{331}}\right)"></p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/239c0bd33998501f6f040a0a53f0757f665b1cb8 alt="=\left({\frac {3}{331}}\right)\left({\frac {5}{331}}\right)\left({\frac {823}{331}}\right)">
 （完全积性）</p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/e27dfd260354631933b8f1a96998af6093847c45 alt="=\left({\frac {3}{331}}\right)\left({\frac {5}{331}}\right)\left({\frac {161}{331}}\right)">
 （161和823关于331同余）</p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/827eecd5ac37c8bb9f0e1708f0752d2741785690 alt="=\left({\frac {3}{331}}\right)\left({\frac {5}{331}}\right)\left({\frac {7}{331}}\right)\left({\frac {23}{331}}\right)">
 （完全积性）</p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/e15893c92c8e69189b6dbe3fc84878f80016cf56 alt="=(-1)\left({\frac {331}{3}}\right)\left({\frac {331}{5}}\right)(-1)\left({\frac {331}{7}}\right)(-1)\left({\frac {331}{23}}\right)">
 （二次互反律）</p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/d9f3d05e8faa1196ae844ff490e380543cf4cd9d alt="=-\left({\frac {1}{3}}\right)\left({\frac {1}{5}}\right)\left({\frac {2}{7}}\right)\left({\frac {9}{23}}\right)">
 （同余数）</p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/4ab36b474cf5d1e547a7c818815d1588f528dcff alt="=-\left({\frac {1}{3}}\right)\left({\frac {1}{5}}\right)\left({\frac {2}{7}}\right)\left({\frac {3}{23}}\right)^{2}">
 （完全积性，平方的形式值一定为1）</p><p><img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/4cf73f630b227bdea61d980f4d945bb8fc2dfafc alt="=-\left(1\right)\left(1\right)\left(1\right)\left(1\right)=-1.">
 （分别计算，可以参考小素数时的分段函数，具体的计算方法见下文）</p><p><a href=https://zh.wikipedia.org/wiki/>维基百科_欧拉准则</a>（用来计算勒让德符号）</p><blockquote>若![p](https://wikimedia.org/api/rest_v1/media/math/render/svg/81eac1e205430d1f40810df36a0edffdc367af36)
是奇[质数](https://zh.wikipedia.org/wiki/)且![p](https://wikimedia.org/api/rest_v1/media/math/render/svg/81eac1e205430d1f40810df36a0edffdc367af36)
不能整除![d](https://wikimedia.org/api/rest_v1/media/math/render/svg/e85ff03cbe0c7341af6b982e47e9f90d235c66ab)
，则：<blockquote><pre><code>![d](https://wikimedia.org/api/rest_v1/media/math/render/svg/e85ff03cbe0c7341af6b982e47e9f90d235c66ab)
</code></pre></blockquote><p>是模<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/81eac1e205430d1f40810df36a0edffdc367af36 alt=p>
的二次剩余<a href=https://zh.wikipedia.org/wiki/>当且仅当</a>：<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/ab89b7999dc3ab653bd541ec9384c7f0ce5f1295 alt="{\displaystyle d^{\frac {p-1}{2}}\equiv 1{\pmod {p}}}"></p><blockquote><pre><code>![d](https://wikimedia.org/api/rest_v1/media/math/render/svg/e85ff03cbe0c7341af6b982e47e9f90d235c66ab)
</code></pre></blockquote><p>是模<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/81eac1e205430d1f40810df36a0edffdc367af36 alt=p>
的非二次剩余当且仅当：<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/0a7379bad3d1f0af0228c293f5179398426161e4 alt="{\displaystyle d^{\frac {p-1}{2}}\equiv -1{\pmod {p}}}"></p><blockquote><p>**以<a href=https://zh.wikipedia.org/wiki/>勒让德符号</a>表示，即为： <img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/351772a3d94b31369024d0855de23d25bb18924d alt="{\displaystyle d^{\frac {p-1}{2}}\equiv \left({\frac {d}{p}}\right){\pmod {p}}}">
**</p></blockquote><blockquote><h3 id=例子一对于给定数寻找其为二次剩余的模数><strong>例子一：对于给定数，寻找其为二次剩余的模数</strong></h3></blockquote><p>令_a_ = 17。对于怎样的质数_p_，17是模_p_的二次剩余呢？</p><p>根据判别法里给出的准则，我们可以从小的质数开始检验。</p><p>首先测试_p_ = 3。我们有：17(3 − 1)/2 = 171 ≡ 2 (mod 3) ≡ -1 (mod 3)，因此17不是模3的二次剩余。</p><p>再来测试_p_ = 13。我们有：17(13 − 1)/2 = 176 ≡ 1 (mod 13)，因此17是模13的二次剩余。实际上我们有：17 ≡ 4 (mod 13)，而22 = 4.</p><p>运用同余性质和<a href=https://zh.wikipedia.org/wiki/>勒让德符号</a>可以加快检验速度。继续算下去，可以得到：</p><blockquote><pre><code>对于质数_p_ =![{\displaystyle 13,19,\cdots }](https://wikimedia.org/api/rest_v1/media/math/render/svg/13f9e1c9d7777e4eaa86f9c200cb0a5dfa30ae89)
</code></pre></blockquote><p>，(17/<em>p</em>) = +1（也就是说17是模这些质数的二次剩余）。</p><blockquote><pre><code>对于质数_p_ =![{\displaystyle 3,5,7,11,23,\cdots }](https://wikimedia.org/api/rest_v1/media/math/render/svg/0ce5efd99278b3d8563cec3f661de8071a7c7b0a)
</code></pre></blockquote><p>，(17/<em>p</em>) = -1（也就是说17是模这些质数的<a href=https://zh.wikipedia.org/wiki/>二次非剩余</a>）。</p><blockquote><pre><code>（**kk:简单得说，就是从小到大枚举质数p，验证a^((p-1)/2)）%p等于1还是-1.）**
</code></pre></blockquote><blockquote><h3 id=heading></h3></blockquote><blockquote></blockquote></blockquote><blockquote><blockquote><blockquote></blockquote><blockquote><blockquote><h3 id=例子二对指定的质数_p_寻找其二次剩余>**例子二：对指定的质数_p_，寻找其二次剩余**</h3></blockquote></blockquote><p>哪些数是模17的二次剩余？</p><p>我们可以手工计算：（<strong>kk:手算考虑数的平方是因为，勒让德符号是完全积性函数&&<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/d5b6f43df4f40202dbf365146ae39d7037387df5 alt="\left({\frac {a^{2}}{p}}\right)=1">
）</strong></p><blockquote><blockquote><pre><code>12 = 1
22 = 4
32 = 9
42 = 16
52 = 25 ≡ 8 (mod 17)
62 = 36 ≡ 2 (mod 17)
72 = 49 ≡ 15 (mod 17)
82 = 64 ≡ 13 (mod 17)
</code></pre><p>于是得到：所有模17的二次剩余的集合是<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/8ad07be15fb1a6748c3baa2a8901312bbefd7df1 alt="{\displaystyle {1,2,4,8,9,13,15,16}}">
。<strong>要注意的是我们只需要算到8，因为9=17-8，9的平方与8的平方模17是同余的</strong>：92 = (−8)2 = 82 ≡ 13 (mod 17).（同理不需计算比9大的数）。</p></blockquote></blockquote><p><strong>但是对于验证一个数是不是模17的二次剩余，就不必将所有模17的二次剩余全部算出</strong>。比如说要检验数字3是否是模17的二次剩余，只需要计算3(17 − 1)/2 = 38 ≡ 812 ≡ ( − 4)2 ≡ − 1 (mod 17)，然后由欧拉准则判定3不是模17的二次剩余。</p><blockquote><blockquote></blockquote></blockquote></blockquote></blockquote><p><a href=https://zh.wikipedia.org/wiki/>维基百科_二次互反律</a></p><blockquote>对于两个奇[素数](https://zh.wikipedia.org/wiki/)![p](https://wikimedia.org/api/rest_v1/media/math/render/svg/81eac1e205430d1f40810df36a0edffdc367af36)
和 ![q](https://wikimedia.org/api/rest_v1/media/math/render/svg/06809d64fa7c817ffc7e323f85997f783dbdf71d)
，![\left({\frac {p}{q}}\right)\cdot \left({\frac {q}{p}}\right)=(-1)^{{{\frac {(p-1)(q-1)}{4}}}}](https://wikimedia.org/api/rest_v1/media/math/render/svg/ea3d157eba9f88a16c19f7606afa04873c76a2b9)<p>其中<img src=https://wikimedia.org/api/rest_v1/media/math/render/svg/da5461d3ff8c55b4d5989cc4cb741a0fcb4c4622 alt="\left({\tfrac {p}{q}}\right)">
是<a href=https://zh.wikipedia.org/wiki/>勒让德符号</a>。</blockquote></p><p>关于二次互反律的证明就不多说了。。。据说高斯一次给出了五个（还是七个？)，到现在一共有200+种证明。</p><p><strong>然后。。。感觉。。。。二次互反律。。。。太神了。。。。太美了。。。。真的被震撼到了orz</strong></p><p><a href=https://en.wikipedia.org/wiki/Cipollas_algorithm>wiki_Cipolla's algorithm</a></p><p><a href=http://blog.csdn.net/acdreamers/article/details/10182281>acdreamer_二次同余方程的解</a>
<a href=http://blog.csdn.net/a_crazy_czy/article/details/51959546>二次剩余Cipolla算法学习小记</a></p><hr><ul class=pager><li class=previous><a href=/2016/10/database-connection-error-/ data-toggle=tooltip data-placement=top title="database connection error 的解决方案">&larr;
Previous Post</a></li><li class=next><a href=/2016/10/crt/ data-toggle=tooltip data-placement=top title=中国剩余定理(crt)学习笔记>Next
Post &rarr;</a></li></ul><div class=post-comment><span id=/2016/10/cipollas-algorithm/ class=leancloud_visitors data-flag-title="二次剩余（Cipolla's algorithm）学习笔记"><span class=post-meta-item-text>访问量</span>
<span class=leancloud-visitors-count></span><p></p></span><div id=vcomments></div><script src=//cdn1.lncld.net/static/js/3.0.4/av-min.js></script><script src=//unpkg.com/valine/dist/Valine.min.js></script><script type=text/javascript>new Valine({el:'#vcomments',appId:'2dzJwxGKq4hbtg5R5NM8NTzJ-gzGzoHsz',appKey:'RaYu8uGTiuiIjLISQppPVYWw',notify:true,verify:false,avatar:'retro',placeholder:'说点什么吧...',visitor:true});</script></div></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5><a href=/tags/>FEATURED TAGS</a></h5><div class=tags><a href=/tags/bfs title=bfs>bfs</a>
<a href=/tags/binary-search title=binary-search>binary-search</a>
<a href=/tags/brute-force title=brute-force>brute-force</a>
<a href=/tags/dfs title=dfs>dfs</a>
<a href=/tags/dp title=dp>dp</a>
<a href=/tags/greedy title=greedy>greedy</a>
<a href=/tags/kmp title=kmp>kmp</a>
<a href=/tags/leetcode title=leetcode>leetcode</a>
<a href=/tags/math title=math>math</a>
<a href=/tags/number-theory title=number-theory>number-theory</a>
<a href=/tags/rmq title=rmq>rmq</a>
<a href=/tags/stl title=stl>stl</a>
<a href=/tags/%E5%89%8D%E7%BC%80%E5%92%8C title=前缀和>前缀和</a>
<a href=/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA title=博弈论>博弈论</a>
<a href=/tags/%E5%9B%BE%E8%AE%BA title=图论>图论</a>
<a href=/tags/%E5%BF%AB%E9%80%9F%E5%B9%82 title=快速幂>快速幂</a>
<a href=/tags/%E6%95%B0%E4%BD%8Ddp title=数位dp>数位dp</a>
<a href=/tags/%E6%9E%84%E9%80%A0 title=构造>构造</a>
<a href=/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84 title=树状数组>树状数组</a>
<a href=/tags/%E6%A8%A1%E6%8B%9F title=模拟>模拟</a>
<a href=/tags/%E6%AF%8D%E5%87%BD%E6%95%B0 title=母函数>母函数</a>
<a href=/tags/%E7%9F%A9%E9%98%B5 title=矩阵>矩阵</a>
<a href=/tags/%E7%BA%BF%E6%AE%B5%E6%A0%91 title=线段树>线段树</a>
<a href=/tags/%E8%AE%A1%E7%AE%97%E5%87%A0%E4%BD%95 title=计算几何>计算几何</a></div></section><section><hr><h5>FRIENDS</h5><ul class=list-inline><li><a target=_blank href=https://111qqz.com>111qqz的wordpress博客</a></li></ul></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href rel=alternate type=application/rss+xml title=111qqz的小窝><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-rss fa-stack-1x fa-inverse"></i></span></a></li><li><a href=mailto:hust.111qqz@gmail.com><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-envelope fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=/img/wechat.jpg><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-wechat fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/111qqz/><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i><i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; 111qqz的小窝 2021<br><a href=https://beian.miit.gov.cn/>粤ICP备18103363号</a><br><a href=https://themes.gohugo.io/hugo-theme-cleanwhite>CleanWhite Hugo Theme</a> by <a href=https://zhaohuabing.com>Huabing</a> |
<iframe style=margin-left:2px;margin-bottom:-5px frameborder=0 scrolling=0 width=100px height=20px src="https://ghbtns.com/github-btn.html?user=zhaohuabing&repo=hugo-theme-cleanwhite&type=star&count=true"></iframe></p></div></div></div></footer><script>function async(u,c){var d=document,t='script',o=d.createElement(t),s=d.getElementsByTagName(t)[0];o.src=u;if(c){o.addEventListener('load',function(e){c(null,e);},false);}
s.parentNode.insertBefore(o,s);}</script><script>if($('#tag_cloud').length!==0){async("/js/jquery.tagcloud.js",function(){$.fn.tagcloud.defaults={color:{start:'#bbbbee',end:'#0085a1'},};$('#tag_cloud a').tagcloud();})}</script><script>async("https://cdnjs.cloudflare.com/ajax/libs/fastclick/1.0.6/fastclick.js",function(){var $nav=document.querySelector("nav");if($nav)FastClick.attach($nav);})</script></body></html>